<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Public health surveillance with surveil • surveil</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Public health surveillance with surveil">
<meta property="og:description" content="surveil">
<meta property="og:image" content="https://connordonegan.github.io/surveil/, https://cloud.r-project.org/web/packages/surveil/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116873024-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116873024-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveil</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ConnorDonegan/surveil/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Public health surveillance with surveil</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ConnorDonegan/surveil/blob/HEAD/vignettes/surveil-demo.Rmd" class="external-link"><code>vignettes/surveil-demo.Rmd</code></a></small>
      <div class="hidden name"><code>surveil-demo.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates basic usage of <strong>surveil</strong> for public health surveillance. <strong>surveil</strong> leverages the principles of Bayesian inference and Markov chain Monte Carlo (MCMC) <span class="citation">(MacKay <a href="#ref-mackay_2003">2003</a>; Gelman et al. <a href="#ref-gelman_2014">2014</a>)</span> to infer population risk of disease or death given time series data consisting of case counts and population at risk. Models were built using the <a href="https://mc-stan.org/" class="external-link">Stan</a> modeling language, but users only need to be familiar with the R language.</p>
<p>The package also contains special methods for age-standardization, printing and plotting model results, and for measuring and visualizing health inequalities. For age-standardization see <code><a href="../articles/age-standardization.html">vignette("age-standardization")</a></code>. For discussion and demonstration analysis see <span class="citation">Donegan, Hughes, and Lee (<a href="#ref-donegan_2022">2022</a>)</span>.</p>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://connordonegan.github.io/surveil/" class="external-link">surveil</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></code></pre></div>
<p>Surveillance data minimally contain case counts, reliable population at risk estimates, and a discrete time period variable. They also may include one or more grouping variables, such as race-ethnicity.Time periods should consist of equally spaced intervals.</p>
<p>This vignette analyzes age-specific (ages 50-79) colorectal cancer incidence data by race-ethnicity, year, and Texas MSA, obtained through CDC Wonder. The race-ethnicity grouping includes (non-Hispanic) Black, (non-Hispanic) White, and Hispanic, and the MSAs include those centered on the cities of Austin, Dallas, Houston, and San Antonio.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">msa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span>, 
        caption <span class="op">=</span> <span class="st">"Glimpse of colorectal cancer incidence data (CDC Wonder)"</span><span class="op">)</span> </code></pre></div>
<table class="table">
<caption>Glimpse of colorectal cancer incidence data (CDC Wonder)</caption>
<thead><tr class="header">
<th align="right">Year</th>
<th align="left">Race</th>
<th align="left">MSA</th>
<th align="right">Count</th>
<th align="right">Population</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1999</td>
<td align="left">Black or African American</td>
<td align="left">Austin-Round Rock, TX</td>
<td align="right">28</td>
<td align="right">14421</td>
</tr>
<tr class="even">
<td align="right">2000</td>
<td align="left">Black or African American</td>
<td align="left">Austin-Round Rock, TX</td>
<td align="right">16</td>
<td align="right">15215</td>
</tr>
<tr class="odd">
<td align="right">2001</td>
<td align="left">Black or African American</td>
<td align="left">Austin-Round Rock, TX</td>
<td align="right">22</td>
<td align="right">16000</td>
</tr>
<tr class="even">
<td align="right">2002</td>
<td align="left">Black or African American</td>
<td align="left">Austin-Round Rock, TX</td>
<td align="right">24</td>
<td align="right">16694</td>
</tr>
<tr class="odd">
<td align="right">2003</td>
<td align="left">Black or African American</td>
<td align="left">Austin-Round Rock, TX</td>
<td align="right">34</td>
<td align="right">17513</td>
</tr>
<tr class="even">
<td align="right">2004</td>
<td align="left">Black or African American</td>
<td align="left">Austin-Round Rock, TX</td>
<td align="right">26</td>
<td align="right">18429</td>
</tr>
</tbody>
</table>
<p><strong>surveil</strong>’s model fitting function, <code>stan_rw</code>, requires that the user provide a <code>data.frame</code> with specific column names. There must be one column named <code>Count</code> containing case counts, and another column named <code>Population</code>, containing the sizes of the populations at risk. The user must provide the name of the column containing the time period, and may optionally provide a grouping factor. For the MSA data printed above, the grouping column is Race and the time column is Year.</p>
</div>
<div class="section level2">
<h2 id="preparing-the-data">Preparing the data<a class="anchor" aria-label="anchor" href="#preparing-the-data"></a>
</h2>
<p>We will demonstrate using aggregated CRC cases across Texas’s top four MSAs. The <code>msa</code> data from CDC Wonder already has the necessary format (column names and contents), but these data are dis-aggregated by MSA. So for this analysis, we first group the data by year and race, and then combine cases across MSAs.</p>
<p>The following code chunk aggregates the data using the <code>dplyr</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tx.msa</span> <span class="op">&lt;-</span> <span class="va">msa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Race</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>Count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Count</span><span class="op">)</span>,
            Population <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Population</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The following code provides a glimpse of the aggregated data (Table 2):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tx.msa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span>, 
        caption <span class="op">=</span> <span class="st">"Glimpse of aggregated Texas metropolitan CRC cases, by race and year"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Glimpse of aggregated Texas metropolitan CRC cases, by race and year</caption>
<thead><tr class="header">
<th align="right">Year</th>
<th align="left">Race</th>
<th align="right">Count</th>
<th align="right">Population</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1999</td>
<td align="left">Black or African American</td>
<td align="right">471</td>
<td align="right">270430</td>
</tr>
<tr class="even">
<td align="right">1999</td>
<td align="left">Hispanic</td>
<td align="right">361</td>
<td align="right">377471</td>
</tr>
<tr class="odd">
<td align="right">1999</td>
<td align="left">White</td>
<td align="right">2231</td>
<td align="right">1654251</td>
</tr>
<tr class="even">
<td align="right">2000</td>
<td align="left">Black or African American</td>
<td align="right">455</td>
<td align="right">283280</td>
</tr>
<tr class="odd">
<td align="right">2000</td>
<td align="left">Hispanic</td>
<td align="right">460</td>
<td align="right">405562</td>
</tr>
<tr class="even">
<td align="right">2000</td>
<td align="left">White</td>
<td align="right">2343</td>
<td align="right">1704425</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="model-specification">Model specification<a class="anchor" aria-label="anchor" href="#model-specification"></a>
</h2>
<div class="section level3">
<h3 id="the-basics">The basics<a class="anchor" aria-label="anchor" href="#the-basics"></a>
</h3>
<p>The base <strong>surveil</strong> model is specified as follows. The Poisson model is used as the likelihood: the probability of observing a given number of cases, <span class="math inline">\(y_t\)</span>, conditional on a given level of risk, <span class="math inline">\(e^{\phi_t}\)</span>, and known population at risk, <span class="math inline">\(p_t\)</span>, is: <span class="math display">\[y_t \sim \text{Pois}(p_t \cdot e^{\phi_t})\]</span> where <span class="math inline">\(t\)</span> indexes the time period.</p>
<p>Alternatively, the binomial model is available: <span class="math display">\[y_t \sim \text{Binom}(p_t \cdot g^{-1}(\phi_t))\]</span> where <span class="math inline">\(g\)</span> is the logit function and <span class="math inline">\(g^{-1}(x) = \frac{exp(x)}{1 + exp(x)}\)</span> (the inverse-logit function). The Poisson model is often preferred for ‘rare’ events (such as rates below .01), otherwise the binomial model is generally more appropriate. The remainder of this vignette will proceed using the Poisson model only.</p>
<p>Next, we build a model for the log-rates, <span class="math inline">\({\phi_t}\)</span> (for the binomial model, the rates are logit-transformed, rather than log-transformed). The first-difference prior states that our expectation for the log-rate at any time is its previous value, and we assign a Gaussian probability distribution to deviations from the previous value <span class="citation">(Clayton <a href="#ref-clayton_1996">1996</a>)</span>. This is also known as the random-walk prior: <span class="math display">\[\phi_t \sim \text{Gau}(\phi_{t-1}, \tau^2)\]</span> This places higher probability on a smooth trend through time, specifically implying that underlying disease risk tends to have less variation than crude incidence.</p>
<p>The log-risk for time <span class="math inline">\(t=1\)</span> has no previous value to anchor its expectation; thus, we assign a prior probability distribution directly to <span class="math inline">\(\phi_1\)</span>. For this prior, <strong>surveil</strong> uses a Gaussian distribution. The scale parameter, <span class="math inline">\(\tau\)</span>, also requires a prior distribution, and again <strong>surveil</strong> uses a Gaussian model.</p>
</div>
<div class="section level3">
<h3 id="multiple-time-series">Multiple time series<a class="anchor" aria-label="anchor" href="#multiple-time-series"></a>
</h3>
<p>For multiple time series, <strong>surveil</strong> allows users to add a correlation structure to the model. This allows our inferences about each population to be mutually informed by inferences about all other observed populations. Note that in many cases, the base model specification described above will be entirely sufficient.</p>
<p>The log-rates for <span class="math inline">\(k\)</span> populations, <span class="math inline">\(\boldsymbol \phi_t\)</span>, are assigned a multivariate Gaussian model <span class="citation">(Brandt and Williams <a href="#ref-brandt_2007">2007</a>)</span>: <span class="math display">\[\boldsymbol \phi_t \sim \text{Gau}(\boldsymbol \phi_{t-1}, \boldsymbol \Sigma),\]</span> where <span class="math inline">\(\boldsymbol \Sigma\)</span> is a <span class="math inline">\(k \times k\)</span> covariance matrix.</p>
<p>The covariance matrix can be decomposed into a diagonal matrix containing scale parameters for each variable, <span class="math inline">\(\boldsymbol \Delta = diag(\tau_1,\dots \tau_k)\)</span>, and a symmetric correlation matrix, <span class="math inline">\(\boldsymbol \Omega\)</span> <span class="citation">(Stan Development Team <a href="#ref-stan_2021">2021</a>)</span>: <span class="math display">\[\boldsymbol \Sigma = \boldsymbol \Delta \boldsymbol \Omega \boldsymbol \Delta\]</span> When the correlation structure is added to the model, then a prior distribution is also required for the correlation matrix. <strong>surveil</strong> uses the LKJ model, which has a single shape parameter, <span class="math inline">\(\eta\)</span> <span class="citation">(Stan Development Team <a href="#ref-stan_2021">2021</a>)</span>. If <span class="math inline">\(\eta=1\)</span>, the LKJ model will place uniform prior probability on any <span class="math inline">\(k \times k\)</span> correlation matrix; as <span class="math inline">\(\eta\)</span> increases from one, it expresses ever greater skepticism towards large correlations. When <span class="math inline">\(\eta &lt;1\)</span>, the LKJ model becomes ‘concave’—expressing skepticism towards correlations of zero.</p>
</div>
</div>
<div class="section level2">
<h2 id="fitting-the-model">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h2>
<p>The time series model is fit by passing surveillance data to the <code>stan_rw</code> function. Here, <code>Year</code> and <code>Race</code> indicate the appropriate time and grouping columns in the <code>tx.msa</code> data frame.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_rw.html">stan_rw</a></span><span class="op">(</span><span class="va">tx.msa</span>,
               time <span class="op">=</span> <span class="va">Year</span>,
           group <span class="op">=</span> <span class="va">Race</span>,
           iter <span class="op">=</span> <span class="fl">1500</span>,
           chains <span class="op">=</span> <span class="fl">2</span>  <span class="co">#, for speed only; use default chains=4</span>
               <span class="op">)</span>
<span class="co">#&gt; Distribution: normal</span>
<span class="co">#&gt; Distribution: normal</span>
<span class="co">#&gt; [1] "Setting normal prior(s) for eta_1: "</span>
<span class="co">#&gt;  location scale</span>
<span class="co">#&gt;        -6     5</span>
<span class="co">#&gt; [1] "\nSetting half-normal prior for sigma: "</span>
<span class="co">#&gt;  location scale</span>
<span class="co">#&gt;         0     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'RW' NOW (CHAIN 1).</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Gradient evaluation took 2e-05 seconds</span>
<span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.2 seconds.</span>
<span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Iteration:    1 / 1500 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  751 / 1500 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 1500 / 1500 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1:  Elapsed Time: 0.258363 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 1:                0.231846 seconds (Sampling)</span>
<span class="co">#&gt; Chain 1:                0.490209 seconds (Total)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'RW' NOW (CHAIN 2).</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Gradient evaluation took 1.3e-05 seconds</span>
<span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.</span>
<span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Iteration:    1 / 1500 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  751 / 1500 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 1500 / 1500 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2:  Elapsed Time: 0.316586 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 2:                0.245818 seconds (Sampling)</span>
<span class="co">#&gt; Chain 2:                0.562404 seconds (Total)</span>
<span class="co">#&gt; Chain 2:</span></code></pre></div>
<p>If we wanted to add a correlation structure to the model, we would add <code>cor = TRUE</code> (as opposed to the default, <code>cor = FALSE</code>). To speed things up, we could take advantage of parallel processing using the <code>cores</code> argument (e.g., add <code>cores = 4</code>) to run on 4 cores simultaneously. For age-standardization, see <code><a href="../articles/age-standardization.html">vignette("age-standardization")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="mcmc-diagnostics">MCMC diagnostics<a class="anchor" aria-label="anchor" href="#mcmc-diagnostics"></a>
</h2>
<p>In this case, Stan did not issue any warnings; this means that all the R-hat values are near to 1 and the Monte Carlo standard errors are reasonably small. We can verify that chains have converged (and R-hats equal about 1):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stan_plot_diagnostics.html" class="external-link">stan_rhat</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">samples</span><span class="op">)</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="surveil-demo_files/figure-html/unnamed-chunk-7-1.png" width="432" style="display: block; margin: auto;"></p>
<p>Other useful functions for examining MCMC diagnostics are <code>rstan::stan_ess(fit$samples)</code> and <code>rstan::stan_mcse(fit$samples)</code>. For an introduction to MCMC analysis with <strong>surveil</strong>, including MCMC diagnostics, see the vignette <code><a href="../articles/surveil-mcmc.html">vignette("surveil-mcmc")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="visualizing-results">Visualizing results<a class="anchor" aria-label="anchor" href="#visualizing-results"></a>
</h2>
<p>If we call <code>plot</code> on a <strong>surveil</strong> model, we get a <code>ggplot</code> object depicting risk estimates with 95% credible intervals:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, scale <span class="op">=</span> <span class="fl">100e3</span>, base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>
<span class="co">#&gt; Plotted rates are per 100,000</span></code></pre></div>
<p><img src="surveil-demo_files/figure-html/unnamed-chunk-8-1.png" width="432" style="display: block; margin: auto;"> Crude incidence rates are also plotted as points.</p>
<p>The <code>plot</code> method has a number of options to control its appearance. For example, the <code>base_size</code> argument controls the size of labels. The size of the points for the crude rates can be adjusted using <code>size</code>, and <code>size = 0</code> removes them altogether. We can also use <code>ggplot</code> to add custom modifications:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, scale <span class="op">=</span> <span class="fl">100e3</span>, base_size <span class="op">=</span> <span class="fl">11</span>, size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Plotted rates are per 100,000</span>
<span class="va">fig</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"CRC incidence per 100,000"</span>,
       subtitle <span class="op">=</span> <span class="st">"Texas MSAs, 50-79 y.o."</span><span class="op">)</span></code></pre></div>
<p><img src="surveil-demo_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The plot method has a <code>style</code> argument that controls how the probability distribution is represented. The default, <code>style = "mean_qi"</code>, shows the mean of the posterior distribution of the risk at each time period with a shaded 95% credible interval (as above). The alternative, <code>style = "lines"</code>, plots MCMC samples from the joint probability distribution across all time periods:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, scale <span class="op">=</span> <span class="fl">100e3</span>, base_size <span class="op">=</span> <span class="fl">11</span>, style <span class="op">=</span> <span class="st">"lines"</span><span class="op">)</span>
<span class="co">#&gt; Plotted rates are per 100,000</span></code></pre></div>
<p><img src="surveil-demo_files/figure-html/unnamed-chunk-10-1.png" width="432" style="display: block; margin: auto;"></p>
<p>By default, <code>M = 250</code> samples are plotted. The <code>style</code> option is available for all of the <strong>surveil</strong> plot methods.</p>
</div>
<div class="section level2">
<h2 id="printing-results">Printing results<a class="anchor" aria-label="anchor" href="#printing-results"></a>
</h2>
<p>The <code>print</code> method will print the estimates with 95% credible intervals to the console:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span>, scale <span class="op">=</span> <span class="fl">100e3</span><span class="op">)</span>
<span class="co">#&gt; Summary of surveil model results</span>
<span class="co">#&gt; Time periods: 19</span>
<span class="co">#&gt; Grouping variable: Race</span>
<span class="co">#&gt; Correlation matrix: FALSE</span>
<span class="co">#&gt;    time                      Race      mean   lwr_2.5  upr_97.5</span>
<span class="co">#&gt; 1  1999 Black or African American 170.01246 157.98969 181.81119</span>
<span class="co">#&gt; 2  2000 Black or African American 166.28707 156.30463 176.64155</span>
<span class="co">#&gt; 3  2001 Black or African American 168.21979 158.49241 177.76281</span>
<span class="co">#&gt; 4  2002 Black or African American 169.06382 159.68532 178.70871</span>
<span class="co">#&gt; 5  2003 Black or African American 166.99554 157.25642 176.69423</span>
<span class="co">#&gt; 6  2004 Black or African American 166.64963 157.32718 177.46076</span>
<span class="co">#&gt; 7  2005 Black or African American 158.89944 150.02064 167.73513</span>
<span class="co">#&gt; 8  2006 Black or African American 154.73518 146.33568 163.52624</span>
<span class="co">#&gt; 9  2007 Black or African American 152.62056 144.37622 161.03935</span>
<span class="co">#&gt; 10 2008 Black or African American 149.77311 141.70215 157.95968</span>
<span class="co">#&gt; 11 2009 Black or African American 143.57548 135.83268 151.64576</span>
<span class="co">#&gt; 12 2010 Black or African American 138.89103 131.98652 146.06689</span>
<span class="co">#&gt; 13 2011 Black or African American 131.01169 123.97772 138.05325</span>
<span class="co">#&gt; 14 2012 Black or African American 125.46654 118.15800 132.54584</span>
<span class="co">#&gt; 15 2013 Black or African American 125.11527 118.26142 131.73641</span>
<span class="co">#&gt; 16 2014 Black or African American 126.24511 120.02506 133.05571</span>
<span class="co">#&gt; 17 2015 Black or African American 122.46925 116.03108 128.70314</span>
<span class="co">#&gt; 18 2016 Black or African American 121.86017 115.45556 128.75496</span>
<span class="co">#&gt; 19 2017 Black or African American 122.36429 115.73665 129.49943</span>
<span class="co">#&gt; 20 1999                  Hispanic 101.53401  94.78429 108.00777</span>
<span class="co">#&gt; 21 2000                  Hispanic 104.12644  98.14130 110.67825</span>
<span class="co">#&gt; 22 2001                  Hispanic 102.51482  96.98401 108.18937</span>
<span class="co">#&gt; 23 2002                  Hispanic 101.46026  96.32235 107.24877</span>
<span class="co">#&gt; 24 2003                  Hispanic 100.49400  95.17999 105.66433</span>
<span class="co">#&gt; 25 2004                  Hispanic 100.86395  96.07851 106.57438</span>
<span class="co">#&gt; 26 2005                  Hispanic  98.57103  93.91013 103.23694</span>
<span class="co">#&gt; 27 2006                  Hispanic  96.87815  92.21519 102.07269</span>
<span class="co">#&gt; 28 2007                  Hispanic  94.18909  89.90937  98.89390</span>
<span class="co">#&gt; 29 2008                  Hispanic  90.49879  85.47552  94.94830</span>
<span class="co">#&gt; 30 2009                  Hispanic  88.70993  84.27980  92.86947</span>
<span class="co">#&gt; 31 2010                  Hispanic  87.91644  83.67085  91.84159</span>
<span class="co">#&gt; 32 2011                  Hispanic  87.33348  83.09833  91.42645</span>
<span class="co">#&gt; 33 2012                  Hispanic  87.87272  83.73342  92.03119</span>
<span class="co">#&gt; 34 2013                  Hispanic  87.30706  83.66046  91.21094</span>
<span class="co">#&gt; 35 2014                  Hispanic  85.84189  82.05655  89.54929</span>
<span class="co">#&gt; 36 2015                  Hispanic  85.83022  82.11391  89.58177</span>
<span class="co">#&gt; 37 2016                  Hispanic  84.79289  80.84719  88.74490</span>
<span class="co">#&gt; 38 2017                  Hispanic  85.89517  81.82401  90.05726</span>
<span class="co">#&gt; 39 1999                     White 135.16203 130.18088 140.06740</span>
<span class="co">#&gt; 40 2000                     White 136.50468 131.70298 141.59965</span>
<span class="co">#&gt; 41 2001                     White 134.14095 129.62203 138.95257</span>
<span class="co">#&gt; 42 2002                     White 130.17990 125.97038 134.31126</span>
<span class="co">#&gt; 43 2003                     White 127.41164 123.17908 131.84235</span>
<span class="co">#&gt; 44 2004                     White 120.03485 115.90386 124.17778</span>
<span class="co">#&gt; 45 2005                     White 115.06502 111.06505 119.02083</span>
<span class="co">#&gt; 46 2006                     White 109.69405 105.90416 113.68644</span>
<span class="co">#&gt; 47 2007                     White 108.20948 104.66659 112.09869</span>
<span class="co">#&gt; 48 2008                     White 103.39353  99.75091 107.18740</span>
<span class="co">#&gt; 49 2009                     White  98.86180  95.36861 102.41334</span>
<span class="co">#&gt; 50 2010                     White  96.13789  92.89184  99.39938</span>
<span class="co">#&gt; 51 2011                     White  93.65297  90.52846  96.79312</span>
<span class="co">#&gt; 52 2012                     White  91.05922  87.90101  94.23520</span>
<span class="co">#&gt; 53 2013                     White  90.09742  87.09160  93.24469</span>
<span class="co">#&gt; 54 2014                     White  91.41577  88.27352  94.64249</span>
<span class="co">#&gt; 55 2015                     White  93.06601  89.97668  96.37288</span>
<span class="co">#&gt; 56 2016                     White  88.99003  86.04799  91.98494</span>
<span class="co">#&gt; 57 2017                     White  92.25455  89.05752  95.52087</span></code></pre></div>
<p>This information is also stored in a data frame, <code>fit$summary</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span>
<span class="co">#&gt;   time        mean     lwr_2.5    upr_97.5                      Race Year Count</span>
<span class="co">#&gt; 1 1999 0.001700125 0.001579897 0.001818112 Black or African American 1999   471</span>
<span class="co">#&gt; 2 2000 0.001662871 0.001563046 0.001766415 Black or African American 2000   455</span>
<span class="co">#&gt; 3 2001 0.001682198 0.001584924 0.001777628 Black or African American 2001   505</span>
<span class="co">#&gt; 4 2002 0.001690638 0.001596853 0.001787087 Black or African American 2002   539</span>
<span class="co">#&gt; 5 2003 0.001669955 0.001572564 0.001766942 Black or African American 2003   546</span>
<span class="co">#&gt; 6 2004 0.001666496 0.001573272 0.001774608 Black or African American 2004   602</span>
<span class="co">#&gt;   Population       Crude</span>
<span class="co">#&gt; 1     270430 0.001741671</span>
<span class="co">#&gt; 2     283280 0.001606185</span>
<span class="co">#&gt; 3     298287 0.001693000</span>
<span class="co">#&gt; 4     313133 0.001721313</span>
<span class="co">#&gt; 5     329481 0.001657152</span>
<span class="co">#&gt; 6     346886 0.001735440</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="measuring-pairwise-inequality">Measuring pairwise inequality<a class="anchor" aria-label="anchor" href="#measuring-pairwise-inequality"></a>
</h2>
<p><strong>surveil</strong> provides a number of functions and methods for measuring health inequalities.</p>
<p>A selection of complementary pairwise inequality measures can be calculated using the <code>group_diff</code> function. The function requires a fitted <strong>surveil</strong> model and character strings corresponding, respectively, to the target population (indicating which group is the target of our inference, typically the overburdened or disadvantaged group), and the reference population. You can also use <code>group_diff</code> to compare two age-stratified populations with age-standardized rates (for details, see <code><a href="../articles/age-standardization.html">vignette("age-standardization")</a></code> and <code><a href="../reference/group_diff.html">?group_diff</a></code>).</p>
<p>It returns probability distributions and summary statements for the following quantities, where <span class="math inline">\(A\)</span> is the incidence rate for the advantaged group, <span class="math inline">\(D\)</span> is the incidence rate of the disadvantaged group, and <span class="math inline">\(P_d\)</span> is the size of the population at risk for the disadvantaged group.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Concept</th>
<th align="center">Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Rate Ratio (RR)</td>
<td align="center"><span class="math inline">\(\frac{D}{A}\)</span></td>
</tr>
<tr class="even">
<td align="left">Rate Difference (RD)</td>
<td align="center"><span class="math inline">\(D - A\)</span></td>
</tr>
<tr class="odd">
<td align="left">Excess Cases (EC)</td>
<td align="center"><span class="math inline">\((D-A) \times P_d\)</span></td>
</tr>
<tr class="even">
<td align="left">Proportion Attributable Risk (PAR)</td>
<td align="center"><span class="math inline">\(\frac{D-A}{D}\)</span></td>
</tr>
</tbody>
</table>
<p>Notice that the PAR is simply the rate difference expressed as a fraction of total risk; it indicates the fraction of risk in the target population that would have been removed had the target rate been equal to the reference rate <span class="citation">(Menvielle, Kulhánová, and Machenbach <a href="#ref-menvielle_2019">2019</a>)</span>. Each of these quantities (RD, RR, PAR, EC) provide a different perspective on the magnitude of a health disparity.</p>
<p>To calculate all of these measures for two groups in our data, we call <code>group_diff</code> on our fitted model:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/group_diff.html">group_diff</a></span><span class="op">(</span><span class="va">fit</span>, target <span class="op">=</span> <span class="st">"Black or African American"</span>, reference <span class="op">=</span> <span class="st">"White"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gd</span>, scale <span class="op">=</span> <span class="fl">100e3</span><span class="op">)</span>
<span class="co">#&gt; Summary of Pairwise Inequality</span>
<span class="co">#&gt; Target group: Black or African American</span>
<span class="co">#&gt; Reference group: White</span>
<span class="co">#&gt; Time periods observed: 19</span>
<span class="co">#&gt; Rate scale: per 100,000</span>
<span class="co">#&gt; Cumulative excess cases (EC): 3,209 [2971, 3441]</span>
<span class="co">#&gt; Cumulative EC as a fraction of group risk (PAR): 0.27 [0.25, 0.28]</span>
<span class="co">#&gt;  time Rate RD  PAR  RR  EC</span>
<span class="co">#&gt;  1999  170 35 0.20 1.3  94</span>
<span class="co">#&gt;  2000  166 30 0.18 1.2  84</span>
<span class="co">#&gt;  2001  168 34 0.20 1.3 102</span>
<span class="co">#&gt;  2002  169 39 0.23 1.3 122</span>
<span class="co">#&gt;  2003  167 40 0.24 1.3 130</span>
<span class="co">#&gt;  2004  167 47 0.28 1.4 162</span>
<span class="co">#&gt;  2005  159 44 0.28 1.4 160</span>
<span class="co">#&gt;  2006  155 45 0.29 1.4 180</span>
<span class="co">#&gt;  2007  153 44 0.29 1.4 186</span>
<span class="co">#&gt;  2008  150 46 0.31 1.4 204</span>
<span class="co">#&gt;  2009  144 45 0.31 1.5 208</span>
<span class="co">#&gt;  2010  139 43 0.31 1.4 209</span>
<span class="co">#&gt;  2011  131 37 0.28 1.4 192</span>
<span class="co">#&gt;  2012  125 34 0.27 1.4 185</span>
<span class="co">#&gt;  2013  125 35 0.28 1.4 197</span>
<span class="co">#&gt;  2014  126 35 0.28 1.4 205</span>
<span class="co">#&gt;  2015  122 29 0.24 1.3 180</span>
<span class="co">#&gt;  2016  122 33 0.27 1.4 209</span>
<span class="co">#&gt;  2017  122 30 0.25 1.3 198</span></code></pre></div>
<p>All of the <strong>surveil</strong> plotting and printing methods provide an option to scale rates by a custom value. By setting <code>scale = 100e3</code> (100,000), the RD is printed as cases per 100,000. Note that none of the other inequality measures (PAR, RR, EC) are ever impacted by this choice.</p>
<p>The plot method for <code>surveil_diff</code> produces one time series <code>ggplot</code> each for RD, PAR, and EC. The means of the probability distributions for each measure are plotted as lines, while the shading indicates a 95% credible interval:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gd</span>, scale <span class="op">=</span> <span class="fl">100e3</span><span class="op">)</span>
<span class="co">#&gt; Rate differences (RD) are per 100,000 at risk</span></code></pre></div>
<p><img src="surveil-demo_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></p>
<p>If we wanted to replace the plot of the PAR with one of the RR, we would set the <code>PAR</code> option to <code>FALSE</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gd</span>, scale <span class="op">=</span> <span class="fl">100e3</span>, PAR <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Rate differences (RD) are per 100,000 at risk</span></code></pre></div>
<p><img src="surveil-demo_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="measuring-inequality-with-multiple-groups">Measuring inequality with multiple groups<a class="anchor" aria-label="anchor" href="#measuring-inequality-with-multiple-groups"></a>
</h2>
<p>Pairwise measures are important, but they cannot provide a summary of inequality across multiple socially situated groups. Theil’s T is an entropy-based inequality index with many favorable qualities, including that it naturally accommodates complex grouping structures <span class="citation">(Theil <a href="#ref-theil_1972">1972</a>; Conceição and Galbraith <a href="#ref-conceicao_2000a">2000</a>; Conceição and Ferreira <a href="#ref-conceicao_2000b">2000</a>)</span>.</p>
<p>Theil’s T measures the extent to which certain populations are overburdened by disease, meaning precisely that the proportion of cases accounted for by a particular group, <span class="math inline">\(\omega_j\)</span>, is higher than the proportion of the population constituted by that same group, <span class="math inline">\(\eta_j\)</span>. With <span class="math inline">\(k\)</span> groups, Theil’s index is <span class="math display">\[T = \sum_{j=1}^k \omega_j \big[ log(\omega_j / \eta_j) \big].\]</span> This is zero when case shares equal population shares and it increases monotonically as the two diverge for any group. Theil’s T is thus a weighted mean of log-ratios of case shares to population shares, where each log-ratio (which we may describe as a raw inequality score) is weighted by its share of total cases.</p>
<p>Theil’s T can be computed from a fitted <strong>surveil</strong> model, the only requirement is that the model includes multiple groups (through the <code>group</code> argument):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/theil.html">theil</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Ts</span><span class="op">)</span>
<span class="co">#&gt; Summary of Theil's Inequality Index</span>
<span class="co">#&gt; Groups:</span>
<span class="co">#&gt; Time periods observed: 19</span>
<span class="co">#&gt; Theil's T (times 100) with 95% credible intervals</span>
<span class="co">#&gt;  time Theil .lower .upper</span>
<span class="co">#&gt;  1999 0.938  0.615  1.279</span>
<span class="co">#&gt;  2000 0.799  0.540  1.090</span>
<span class="co">#&gt;  2001 0.902  0.625  1.206</span>
<span class="co">#&gt;  2002 0.980  0.703  1.295</span>
<span class="co">#&gt;  2003 0.994  0.707  1.327</span>
<span class="co">#&gt;  2004 1.067  0.756  1.454</span>
<span class="co">#&gt;  2005 0.996  0.701  1.335</span>
<span class="co">#&gt;  2006 1.049  0.735  1.414</span>
<span class="co">#&gt;  2007 1.101  0.775  1.469</span>
<span class="co">#&gt;  2008 1.250  0.884  1.674</span>
<span class="co">#&gt;  2009 1.209  0.833  1.622</span>
<span class="co">#&gt;  2010 1.137  0.814  1.495</span>
<span class="co">#&gt;  2011 0.917  0.611  1.286</span>
<span class="co">#&gt;  2012 0.778  0.485  1.128</span>
<span class="co">#&gt;  2013 0.815  0.542  1.131</span>
<span class="co">#&gt;  2014 0.858  0.590  1.184</span>
<span class="co">#&gt;  2015 0.680  0.439  0.951</span>
<span class="co">#&gt;  2016 0.802  0.523  1.163</span>
<span class="co">#&gt;  2017 0.711  0.457  1.049</span></code></pre></div>
<p>The probability distribution for Theil’s T can be summarized visualy using the <code>"lines"</code> style plot or by plotting estimates with shaded 95% credible intervals:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Ts</span><span class="op">)</span></code></pre></div>
<p><img src="surveil-demo_files/figure-html/unnamed-chunk-17-1.png" width="384" style="display: block; margin: auto;"></p>
<p>While the minimum of Theil’s index is always zero, the maximum value varies with the structure of the population under observation. The index is useful for comparisons such as monitoring change over time, and should generally not be used as a indication of the absolute level of inequality.</p>
<p>The index also has interesting extensions; for example, given disease data for a nested population structure—such as racial-ethnic groups within states—Theil’s index can provide a measure of geographic inequality across states (between-state inequality), and social inequality within states (within-state inequality) <span class="citation">(Conceição, Galbraith, and Bradford <a href="#ref-conceiccao_2001">2001</a>)</span>. For details, see <code><a href="../reference/theil.html">?theil</a></code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-brandt_2007">
<p>Brandt, P, and JT Williams. 2007. <em>Multiple Time Series Models</em>. Sage.</p>
</div>
<div id="ref-clayton_1996">
<p>Clayton, DG. 1996. “Generalized Linear Mixed Models.” In <em>Markov Chain Monte Carlo in Practice: Interdisciplinary Statistics</em>, edited by WR Gilks, S Richardson, and DJ Spiegelhalter, 275–302. CRC Press.</p>
</div>
<div id="ref-conceicao_2000b">
<p>Conceição, Pedro, and Pedro Ferreira. 2000. “The Young Person’s Guide to the Theil Index: Suggesting Intuitive Interpretations and Exploring Analytical Applications.” <em>University of Texas Inequality Project (UTIP)</em>. <a href="https://utip.gov.utexas.edu/papers.html" class="external-link">https://utip.gov.utexas.edu/papers.html</a>.</p>
</div>
<div id="ref-conceicao_2000a">
<p>Conceição, Pedro, and James K. Galbraith. 2000. “Constructing Long and Dense Time Series of Inequality Using the Theil Index.” <em>Eastern Economic Journal</em> 26 (1): 61–74.</p>
</div>
<div id="ref-conceiccao_2001">
<p>Conceição, Pedro, James K Galbraith, and Peter Bradford. 2001. “The Theil Index in Sequences of Nested and Hierarchic Grouping Structures: Implications for the Measurement of Inequality Through Time, with Data Aggregated at Different Levels of Industrial Classification.” <em>Eastern Economic Journal</em> 27 (4): 491–514.</p>
</div>
<div id="ref-donegan_2022">
<p>Donegan, Connor, Amy E. Hughes, and Simon J. Craddock Lee. 2022. “Colorectal Cancer Incidence, Inequality, and Prevention Priorities in Urban Texas: Surveillance Study with the ‘Surveil’ Software Pakcage.” <em>JMIR Public Health &amp; Surveillance</em> 8 (8): e34589. <a href="https://doi.org/10.2196/34589" class="external-link">https://doi.org/10.2196/34589</a>.</p>
</div>
<div id="ref-gelman_2014">
<p>Gelman, Andrew, John B Carlin, Hal S Stern, David B Dunson, Aki Vehtari, and Donald B Rubin. 2014. <em>Bayesian Data Analysis</em>. Third. CRC Press.</p>
</div>
<div id="ref-mackay_2003">
<p>MacKay, David M. 2003. <em>Information Theory, Inference, and Learning Algorithms</em>. Cambridge University Press.</p>
</div>
<div id="ref-menvielle_2019">
<p>Menvielle, Gwenn, Kulhánová, and Johan P. Machenbach. 2019. “Assessing the Impact of a Public Health Intervention to Reduce Social Inequalities in Cancer.” In <em>Reducing Social Inequalities in Cancer: Evidence and Priorities for Research</em>, edited by Salvatore Vaccarella, Joannie Lortet-Tieulent, Rodolfo Saracci, David I. Conway, Kurt Straif, and Christopher P. Wild, 185–92. Geneva, Switzerland: WHO Press.</p>
</div>
<div id="ref-stan_2021">
<p>Stan Development Team. 2021. <em>Stan Modeling Language Users Guide and Reference Manual, 2.28</em>. <a href="https://mc-stan.org" class="external-link">https://mc-stan.org</a>.</p>
</div>
<div id="ref-theil_1972">
<p>Theil, Henry. 1972. <em>Statistical Decomposition Analysis</em>. Amsterdam, The Netherlands; London, UK: North-Holland Publishing Company.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Connor Donegan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
