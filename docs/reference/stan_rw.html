<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Time series models for mortality and disease incidence — stan_rw • surveil</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Time series models for mortality and disease incidence — stan_rw"><meta property="og:description" content="Model time-varying incidence rates given a time series of case (or death) counts and population at risk."><meta property="og:image" content="https://connordonegan.github.io/surveil/, https://cloud.r-project.org/web/packages/surveil/index.html/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116873024-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116873024-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveil</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ConnorDonegan/surveil/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Time series models for mortality and disease incidence</h1>
    <small class="dont-index">Source: <a href="https://github.com/ConnorDonegan/surveil/blob/HEAD/R/stan_rw.R" class="external-link"><code>R/stan_rw.R</code></a></small>
    <div class="hidden name"><code>stan_rw.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Model time-varying incidence rates given a time series of case (or death) counts and population at risk.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">stan_rw</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">group</span>,
  <span class="va">time</span>,
  cor <span class="op">=</span> <span class="cn">FALSE</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,
  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  chains <span class="op">=</span> <span class="fl">4</span>,
  cores <span class="op">=</span> <span class="fl">1</span>,
  iter <span class="op">=</span> <span class="fl">3000</span>,
  refresh <span class="op">=</span> <span class="fl">1500</span>,
  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.98</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="source">
    <h2>Source</h2>
    <p>Brandt P and Williams JT. Multiple time series models. Thousand Oaks, CA: SAGE Publications, 2007.</p>
<p>Clayton, DG. Generalized linear mixed models. In: Gilks WR, Richardson S, Spiegelhalter DJ, editors. Markov Chain Monte Carlo in Practice: Interdisciplinary Statistics. Boca Raton, FL: CRC Press, 1996. p. 275-302.</p>
<p>Donegan C, Hughes AE, and Lee SC (2022). Colorectal Cancer Incidence, Inequalities, and Prevention Priorities in Urban Texas: Surveillance Study With the "surveil" Software Package. <em>JMIR Public Health &amp; Surveillance</em> 8(8):e34589. <a href="https://doi.org/10.2196/34589" class="external-link">doi:10.2196/34589</a></p>
<p>Stan Development Team. Stan Modeling Language Users Guide and Reference Manual, 2.28. 2021. https://mc-stan.org</p>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A <code>data.frame</code> containing the following columns:</p><dl><dt>Count</dt>
<dd><p>Number of cases or deaths; this column must be named 'Count'.</p></dd>

<dt>Population</dt>
<dd><p>Size of population at risk; this column must be named 'Population'.</p></dd>

<dt>time</dt>
<dd><p>Time period indicator. (Provide the (unquoted) column name using the <code>time</code> argument.)</p></dd>

<dt>group</dt>
<dd><p>Optional grouping variable. (Provide the (unquoted) column name using the <code>group</code> argument.)</p></dd>


</dl></dd>
<dt>group</dt>
<dd><p>If <code>data</code> is aggregated by demographic group, provide the (unquoted) name of the column in <code>data</code> containing the grouping structure, such as age brackets or race-ethnicity. E.g., if <code>data</code> has column names <code>Year</code>, <code>Race</code>, <code>Cases</code>, and <code>Population</code>, then you would provide <code>group = Race</code>.</p></dd>
<dt>time</dt>
<dd><p>Specify the (unquoted) name of the time variable in <code>data</code>, as in <code>time = Year</code>. This variable must be numeric-alike (i.e., <code>as.numeric(data$time)</code> will not fail).</p></dd>
<dt>cor</dt>
<dd><p>For correlated random walks use <code>cor = TRUE</code>; default value is <code>FALSE</code>. Note this only applies when the <code>group</code> argument is used.</p></dd>
<dt>family</dt>
<dd><p>The default specification is a Poisson model with log link function (<code>family = poisson()</code>). For a Binomial model with logit link function, use <code>family = binomial()</code>.</p></dd>
<dt>prior</dt>
<dd><p>Optionally provide a named <code>list</code> with prior parameters. If any of the following items are missing, default priors will be assigned and printed to the console.</p>
<dl><dt>eta_1</dt>
<dd><p>The first value of log-risk in each series must be assigned a Gaussian prior probability distribution. Provide the location and scale parameters for each demographic group in a list, where each parameter is a <code>k</code>-length vector.</p>
<p>For example, with <code>k=2</code> demographic groups, the following code will assign priors of <code>normal(-6.5, 5)</code> to the starting values of both series: <code>prior = list(eta_1 = normal(location = -6.5, scale = 5, k = 2)</code>. Note, <code>eta</code> is the log-rate, so centering the prior for <code>eta_1</code> on <code>-6.5</code> is similar to centering the prior rate on <code>exp(-6.5)*100,000 = 150</code> cases per 100,000 person-years at risk. Note, however, that the translation from log-rate to rate is non-linear.</p></dd>


<dt>sigma</dt>
<dd><p>Each demographic group has a scale parameter assigned to its log-rate. This is the scale of the annual deviations from the previous year's log-rate. The scale parameters are assigned independent half-normal prior distributions (these <code>half</code> normal distributions are restricted to be positive-valued only).</p></dd>


<dt>omega</dt>
<dd><p>If <code>cor = TRUE</code>, an LKJ prior is assigned to the correlation matrix, Omega.</p></dd>


</dl></dd>
<dt>chains</dt>
<dd><p>Number of independent MCMC chains to initiate (passed to <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">sampling</a></code>).</p></dd>
<dt>cores</dt>
<dd><p>The number of cores to use when executing the Markov chains in parallel (passed to <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">sampling</a></code>).</p></dd>
<dt>iter</dt>
<dd><p>Total number of MCMC iterations. Warmup draws are automatically half of <code>iter</code>.</p></dd>
<dt>refresh</dt>
<dd><p>How often to print the MCMC sampling progress to the console.</p></dd>
<dt>control</dt>
<dd><p>A named list of parameters to control Stan's sampling behavior. The most common parameters to control are <code>adapt_delta</code>, which may be raised to address divergent transitions, and <code>max_treedepth</code>. For example, <code>control = list(adapt_delta = 0.99, max_treedepth = 13)</code>, may be a reasonable specification to address a divergent transitions or maximum treedepth warning from Stan.</p></dd>
<dt>...</dt>
<dd><p>Other arguments passed to <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">sampling</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The function returns a list, also of class <code>surveil</code>, containing the following elements:</p><dl><dt>summary</dt>
<dd><p>A <code>data.frame</code> with posterior means and 95 percent credible intervals, as well as the raw data (Count, Population,  time period, grouping variable if any, and crude rates).</p></dd>


<dt>samples</dt>
<dd><p>A <code>stanfit</code> object returned by <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">sampling</a></code>. This contains the MCMC samples from the posterior distribution of the fitted model.</p></dd>


<dt>cor</dt>
<dd><p>Logical value indicating if the model included a correlation structure.</p></dd>


<dt>time</dt>
<dd><p>A list containing the name of the time-period column in the user-provided data and a <code>data.frame</code> of observed time periods and their index.</p></dd>


<dt>group</dt>
<dd><p>If a grouping variable was used, this will be a list containing the name of the grouping variable and a <code>data.frame</code> with group labels and index values.</p></dd>


<dt>family</dt>
<dd><p>The user-provided <code>family</code> argument.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>By default, the models have Poisson likelihoods for the case counts, with log link function. Alternatively, a Binomial model with logit link function can be specified using the <code>family</code> argument (<code>family = binomial()</code>).</p>
<p>For time t = 1,...n, the models assign Poisson probability distribution to the case counts, given log-risk <code>eta</code> and population at tirks P; the log-risk is modeled using the first-difference (or random-walk) prior:</p><div class="sourceCode"><pre><code> y_t ~ Poisson(p_t * exp(eta_t))
 eta_t ~ Normal(eta_{t-1}, sigma)
 eta_1 ~ Normal(-6, 5) (-Inf, 0)
 sigma ~ Normal(0, 1) (0, Inf)
</code></pre></div>

<p>This style of model has been discussed in Bayesian (bio)statistics for quite some time. See Clayton (1996).</p>
<p>The above model can be used for multiple distinct groups; in that case, each group will have its own independent time series model.</p>
<p>It is also possible to add a correlation structure to that set of models. Let <code>Y_t</code> be a k-length vector of observations for each of k groups at time t (the capital letter now indicates a vector), then:</p><div class="sourceCode"><pre><code> Y_t ~ Poisson(P_t * exp(Eta_t))
 Eta_t ~ MVNormal(Eta_{t-1}, Sigma)
 Eta_1 ~ Normal(-6, 5)  (-Inf, 0)
 Sigma = diag(sigma) * Omega * diag(sigma)
 Omega ~ LKJ(2)
 sigma ~ Normal(0, 1) (0, Inf)
</code></pre></div>

<p>where <code>Omega</code> is a correlation matrix and <code>diag(sigma)</code> is a diagonal matrix with scale parameters on the diagonal. This was adopted from Brandt and Williams (2007); for the LKJ prior, see the Stan Users Guide and Reference Manual.</p>
<p>If the binomial model is used instead of the Poisson, then the first line of the model specifications will be:</p><div class="sourceCode"><pre><code><span class="va">y_t</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">P_t</span>, <span class="fu">inverse_logit</span><span class="op">(</span><span class="va">eta_t</span><span class="op">)</span><span class="op">)</span></code></pre></div>

<p>All else is remains the same. The logit function is <code>log(r/(1-r))</code>, where <code>r</code> is a rate between zero and one; the inverse-logit function is <code>exp(x)/(1 + exp(x))</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>vignette("demonstration", package = "surveil")</code> <code><a href="../articles/age-standardization.html">vignette("age-standardization", package = "surveil")</a></code> <code><a href="apc.html">apc</a></code> <code><a href="standardize.html">standardize</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Connor Donegan (Connor.Donegan@UTSouthwestern.edu)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstan/" class="external-link">rstan</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: StanHeaders</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: ggplot2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> rstan (Version 2.21.5, GitRev: 2e1f913d3ca3)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> options(mc.cores = parallel::detectCores()).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To avoid recompilation of unchanged Stan programs, we recommend calling</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> rstan_options(auto_write = TRUE)</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">msa</span><span class="op">)</span></span>
<span class="r-in"><span class="va">austin</span> <span class="op">&lt;-</span> <span class="va">msa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Austin"</span>, <span class="va">msa</span><span class="op">$</span><span class="va">MSA</span><span class="op">)</span>, <span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">stan_rw</span><span class="op">(</span><span class="va">austin</span>,</span>
<span class="r-in">               time <span class="op">=</span> <span class="va">Year</span>,</span>
<span class="r-in">               group <span class="op">=</span> <span class="va">Race</span>,</span>
<span class="r-in">               chains <span class="op">=</span> <span class="fl">2</span>, iter <span class="op">=</span> <span class="fl">900</span><span class="op">)</span> <span class="co"># for speed only</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Setting normal prior(s) for eta_1: "</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Distribution: normal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  location scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        -6     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "\nSetting half-normal prior for sigma: "</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Distribution: normal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  location scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'RW' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 2.2e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.22 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:   1 / 900 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 451 / 900 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 900 / 900 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 0.266614 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                0.251356 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                0.51797 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'RW' NOW (CHAIN 2).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Gradient evaluation took 1.4e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.14 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:   1 / 900 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 451 / 900 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 900 / 900 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:  Elapsed Time: 0.288353 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                0.237164 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                0.525517 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## MCMC diagnostics</span></span>
<span class="r-in"><span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stan_plot_diagnostics.html" class="external-link">stan_mcse</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">samples</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="r-plt img"><img src="stan_rw-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stan_plot_diagnostics.html" class="external-link">stan_rhat</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">samples</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="r-plt img"><img src="stan_rw-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">samples</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inference for Stan model: RW.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 chains, each with iter=900; warmup=450; thin=1; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> post-warmup draws per chain=450, total post-warmup draws=900.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 mean se_mean    sd   2.5%    25%    50%    75%  97.5% n_eff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,1]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,2]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,3]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,4]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,5]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,6]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,7]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,8]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,9]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,10]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,11]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,12]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,13]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,14]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,15]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,16]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,17]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,18]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,19]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,1]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,2]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,3]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,4]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,5]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,6]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,7]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,8]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,9]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,10]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,11]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,12]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,13]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,14]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,15]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,16]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,17]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,18]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,19]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,1]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,2]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,3]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,4]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,5]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,6]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,7]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1399</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,8]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,9]       0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,10]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,11]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,12]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,13]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,14]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,15]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,16]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00   908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,17]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,18]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,19]      0.00    0.00  0.00   0.00   0.00   0.00   0.00   0.00  1256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma[1]        0.15    0.01  0.08   0.03   0.09   0.14   0.20   0.32    74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma[2]        0.10    0.00  0.04   0.04   0.07   0.09   0.12   0.18   212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma[3]        0.08    0.00  0.02   0.05   0.07   0.08   0.09   0.14   310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,1]   -3.43    0.04  0.80  -5.48  -3.83  -3.20  -2.78  -2.59   484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,2]   -3.18    0.02  0.68  -4.86  -3.56  -3.03  -2.66  -2.32   891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,3]   -2.64    0.01  0.24  -3.35  -2.69  -2.55  -2.48  -2.47   567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,4]   -2.70    0.01  0.28  -3.55  -2.74  -2.59  -2.53  -2.51   447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,5]   -3.66    0.06  0.84  -5.63  -4.17  -3.48  -2.99  -2.69   198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,6]   -2.72    0.01  0.24  -3.40  -2.78  -2.62  -2.57  -2.55   738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,7]   -2.74    0.01  0.23  -3.35  -2.78  -2.66  -2.59  -2.57   439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,8]   -2.79    0.01  0.36  -3.75  -2.87  -2.66  -2.56  -2.53   658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,9]   -2.82    0.01  0.32  -3.79  -2.85  -2.70  -2.64  -2.62   484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,10]  -2.81    0.02  0.30  -3.75  -2.85  -2.70  -2.64  -2.62   257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,11]  -2.85    0.01  0.30  -3.58  -2.91  -2.74  -2.67  -2.65   415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,12]  -3.74    0.03  0.86  -5.90  -4.17  -3.53  -3.11  -2.76   832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,13]  -4.00    0.11  1.13  -6.44  -4.81  -3.80  -3.09  -2.41   109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,14]  -5.05    0.18  1.68  -8.61  -6.18  -4.80  -3.78  -2.45    92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,15]  -3.43    0.03  0.66  -5.10  -3.69  -3.26  -2.94  -2.78   593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,16]  -3.17    0.02  0.47  -4.60  -3.31  -3.02  -2.84  -2.79   387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,17]  -3.17    0.02  0.52  -4.57  -3.39  -3.02  -2.78  -2.69   735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,18]  -3.12    0.02  0.42  -4.36  -3.20  -2.95  -2.85  -2.82   543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,19]  -3.15    0.03  0.46  -4.57  -3.21  -2.96  -2.86  -2.82   317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,1]   -2.94    0.01  0.31  -3.75  -3.01  -2.83  -2.76  -2.74   631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,2]   -3.01    0.01  0.28  -3.83  -3.07  -2.89  -2.82  -2.80   648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,3]   -3.55    0.03  0.69  -5.39  -3.86  -3.40  -3.08  -2.72   613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,4]   -3.57    0.02  0.56  -4.98  -3.83  -3.44  -3.14  -2.93   738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,5]   -3.11    0.01  0.27  -3.85  -3.20  -3.01  -2.92  -2.90   686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,6]   -3.41    0.02  0.50  -4.67  -3.64  -3.26  -3.03  -2.95   769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,7]   -3.08    0.01  0.26  -3.78  -3.13  -2.98  -2.93  -2.92   484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,8]   -3.25    0.02  0.40  -4.30  -3.35  -3.11  -2.99  -2.95   590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,9]   -3.08    0.01  0.31  -3.96  -3.13  -2.97  -2.92  -2.90   459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,10]  -3.66    0.03  0.74  -5.35  -4.08  -3.47  -3.09  -2.82   689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,11]  -3.11    0.01  0.25  -3.82  -3.18  -3.02  -2.94  -2.92   510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,12]  -3.11    0.01  0.26  -3.83  -3.17  -3.02  -2.95  -2.93   469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,13]  -3.17    0.01  0.28  -3.88  -3.25  -3.07  -3.00  -2.98   416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,14]  -3.43    0.02  0.47  -4.80  -3.58  -3.25  -3.11  -3.06   518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,15]  -3.53    0.02  0.57  -5.03  -3.78  -3.37  -3.10  -2.99   650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,16]  -3.49    0.02  0.51  -4.89  -3.73  -3.34  -3.11  -3.02   637</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,17]  -3.64    0.02  0.52  -4.95  -3.88  -3.47  -3.26  -3.18   853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,18]  -3.50    0.02  0.43  -4.72  -3.61  -3.34  -3.23  -3.19   624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,19]  -3.51    0.02  0.47  -4.87  -3.65  -3.31  -3.21  -3.18   456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,1]   -3.91    0.02  0.47  -5.35  -4.02  -3.72  -3.61  -3.57   385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,2]   -3.87    0.02  0.46  -5.09  -3.95  -3.71  -3.61  -3.58   417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,3]   -4.73    0.04  0.94  -6.84  -5.24  -4.51  -3.96  -3.67   697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,4]   -3.85    0.02  0.35  -4.81  -3.91  -3.72  -3.63  -3.60   492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,5]   -3.84    0.02  0.35  -4.82  -3.94  -3.70  -3.61  -3.59   415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,6]   -3.93    0.02  0.50  -5.29  -4.07  -3.75  -3.60  -3.55   690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,7]   -3.94    0.02  0.49  -5.28  -4.04  -3.76  -3.63  -3.60   581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,8]   -3.93    0.02  0.49  -5.41  -4.09  -3.72  -3.60  -3.56   553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,9]   -3.94    0.02  0.44  -5.20  -4.09  -3.77  -3.64  -3.61   685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,10]  -3.88    0.02  0.40  -4.98  -3.99  -3.73  -3.61  -3.58   661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,11]  -3.88    0.02  0.41  -5.02  -3.99  -3.72  -3.62  -3.58   634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,12]  -3.87    0.02  0.35  -4.90  -3.95  -3.74  -3.64  -3.61   539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,13]  -3.91    0.02  0.38  -4.96  -3.99  -3.76  -3.66  -3.63   540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,14]  -3.93    0.02  0.43  -5.04  -4.02  -3.77  -3.67  -3.64   570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,15]  -4.11    0.02  0.61  -5.71  -4.29  -3.89  -3.69  -3.61   822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,16]  -4.16    0.02  0.62  -5.88  -4.41  -3.94  -3.71  -3.64   935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,17]  -4.69    0.03  0.95  -7.42  -5.10  -4.43  -3.96  -3.76   750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,18]  -3.98    0.02  0.36  -4.94  -4.07  -3.84  -3.75  -3.72   561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,19]  -4.07    0.02  0.48  -5.44  -4.15  -3.89  -3.77  -3.74   526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lp__          -57.73    1.03 10.01 -76.93 -64.57 -58.42 -51.35 -36.54    95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Rhat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,1]     1.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,2]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,3]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,4]     1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,5]     1.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,6]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,7]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,8]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,9]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,10]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,11]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,12]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,13]    1.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,14]    1.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,15]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,16]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,17]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,18]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[1,19]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,1]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,2]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,3]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,4]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,5]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,6]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,7]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,8]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,9]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,10]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,11]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,12]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,13]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,14]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,15]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,16]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,17]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,18]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[2,19]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,1]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,2]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,3]     1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,4]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,5]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,6]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,7]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,8]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,9]     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,10]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,11]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,12]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,13]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,14]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,15]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,16]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,17]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,18]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate[3,19]    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma[1]      1.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma[2]      1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma[3]      1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,1]  1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,2]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,3]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,4]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,5]  1.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,6]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,7]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,8]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,9]  1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,10] 1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,11] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,12] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,13] 1.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,14] 1.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,15] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,16] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,17] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,18] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[1,19] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,1]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,2]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,3]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,4]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,5]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,6]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,7]  1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,8]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,9]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,10] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,11] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,12] 1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,13] 1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,14] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,15] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,16] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,17] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,18] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[2,19] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,1]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,2]  1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,3]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,4]  1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,5]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,6]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,7]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,8]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,9]  1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,10] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,11] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,12] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,13] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,14] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,15] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,16] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,17] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,18] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_lik[3,19] 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lp__          1.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Samples were drawn using NUTS(diag_e) at Sun Aug 21 17:48:32 2022.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For each parameter, n_eff is a crude measure of effective sample size,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> and Rhat is the potential scale reduction factor on split chains (at </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> convergence, Rhat=1).</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## print the surveil object</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Summary of surveil model results</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Time periods: 19</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Grouping variable: Race</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Correlation matrix: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time                      Race         mean      lwr_2.5     upr_97.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1999 Black or African American 0.0015848412 0.0011877953 0.0020828178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2000 Black or African American 0.0014019580 0.0010260474 0.0017615104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2001 Black or African American 0.0014283937 0.0011050316 0.0017735582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2002 Black or African American 0.0014715590 0.0011429487 0.0018568079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2003 Black or African American 0.0015693765 0.0012417251 0.0019721611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2004 Black or African American 0.0014428772 0.0011563549 0.0017844306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2005 Black or African American 0.0013706806 0.0011062975 0.0016825717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2006 Black or African American 0.0012897184 0.0010310250 0.0015841298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2007 Black or African American 0.0012856628 0.0010036486 0.0015798873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2008 Black or African American 0.0012633995 0.0010151185 0.0015940207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2009 Black or African American 0.0012394670 0.0010108120 0.0015331413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2010 Black or African American 0.0012040869 0.0009541221 0.0015364278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 2011 Black or African American 0.0009677841 0.0006712559 0.0012181372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2012 Black or African American 0.0009285542 0.0006307269 0.0011990754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2013 Black or African American 0.0011209930 0.0009077986 0.0013896400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2014 Black or African American 0.0011644625 0.0009268687 0.0014516202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2015 Black or African American 0.0011081610 0.0008679827 0.0013353059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 2016 Black or African American 0.0011780060 0.0009483577 0.0014390586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 2017 Black or African American 0.0011795713 0.0009187807 0.0014879843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 1999                  Hispanic 0.0012607261 0.0010181604 0.0015269117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 2000                  Hispanic 0.0012518041 0.0010499970 0.0014706339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 2001                  Hispanic 0.0012234715 0.0010375369 0.0014511210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 2002                  Hispanic 0.0012811025 0.0011013518 0.0015046711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 2003                  Hispanic 0.0012678221 0.0010877001 0.0014945238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 2004                  Hispanic 0.0012383464 0.0010567973 0.0014612468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 2005                  Hispanic 0.0011631912 0.0009968949 0.0013634654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 2006                  Hispanic 0.0010876692 0.0009291861 0.0012608316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 2007                  Hispanic 0.0009825842 0.0008310177 0.0011347561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 2008                  Hispanic 0.0008963600 0.0007433791 0.0010431272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 2009                  Hispanic 0.0008845585 0.0007414726 0.0010237806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 2010                  Hispanic 0.0008672868 0.0007419308 0.0009955945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 2011                  Hispanic 0.0008607720 0.0007310035 0.0009842923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 2012                  Hispanic 0.0008659974 0.0007368001 0.0010056321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 2013                  Hispanic 0.0008268198 0.0007019712 0.0009509387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 2014                  Hispanic 0.0008377413 0.0007211132 0.0009568969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 2015                  Hispanic 0.0008980142 0.0007905817 0.0010318797</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 2016                  Hispanic 0.0009028189 0.0007817692 0.0010285969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 2017                  Hispanic 0.0008831297 0.0007425296 0.0010351708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 1999                     White 0.0012876573 0.0011469237 0.0014441607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 2000                     White 0.0012775066 0.0011623148 0.0014101655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 2001                     White 0.0013081191 0.0011992683 0.0014566390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 2002                     White 0.0011983149 0.0010967010 0.0013125061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 2003                     White 0.0011055254 0.0010035420 0.0012096700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 2004                     White 0.0010181684 0.0009193822 0.0011165098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 2005                     White 0.0009843363 0.0008902500 0.0010846319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 2006                     White 0.0009142544 0.0008212150 0.0010093236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 2007                     White 0.0008909681 0.0008107812 0.0009798419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 2008                     White 0.0008350734 0.0007547688 0.0009127109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 2009                     White 0.0008079786 0.0007286936 0.0008877702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 2010                     White 0.0007959113 0.0007251886 0.0008711637</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51 2011                     White 0.0007880309 0.0007191357 0.0008635822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52 2012                     White 0.0007648297 0.0006945550 0.0008383179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53 2013                     White 0.0007293816 0.0006578930 0.0007981264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54 2014                     White 0.0007411043 0.0006717365 0.0008103823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55 2015                     White 0.0008107933 0.0007352741 0.0008877417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56 2016                     White 0.0007930961 0.0007287631 0.0008556438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57 2017                     White 0.0007987410 0.0007259067 0.0008764836</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time        mean     lwr_2.5    upr_97.5                      Race Year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1999 0.001584841 0.001187795 0.002082818 Black or African American 1999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2000 0.001401958 0.001026047 0.001761510 Black or African American 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2001 0.001428394 0.001105032 0.001773558 Black or African American 2001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2002 0.001471559 0.001142949 0.001856808 Black or African American 2002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2003 0.001569377 0.001241725 0.001972161 Black or African American 2003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2004 0.001442877 0.001156355 0.001784431 Black or African American 2004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     MSA Count Population       Crude</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Austin-Round Rock, TX    28      14421 0.001941613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Austin-Round Rock, TX    16      15215 0.001051594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Austin-Round Rock, TX    22      16000 0.001375000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Austin-Round Rock, TX    24      16694 0.001437642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Austin-Round Rock, TX    34      17513 0.001941415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Austin-Round Rock, TX    26      18429 0.001410820</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## plot time trends</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, style <span class="op">=</span> <span class="st">'lines'</span><span class="op">)</span></span>
<span class="r-plt img"><img src="stan_rw-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## age-specific rates and cumulative percent change</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">stan_rw</span><span class="op">(</span><span class="va">cancer</span>, time <span class="op">=</span> <span class="va">Year</span>, group <span class="op">=</span> <span class="va">Age</span>,</span>
<span class="r-in">              chains <span class="op">=</span> <span class="fl">2</span>, iter <span class="op">=</span> <span class="fl">900</span><span class="op">)</span> <span class="co"># for speed only</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Setting normal prior(s) for eta_1: "</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Distribution: normal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  location scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        -6     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "\nSetting half-normal prior for sigma: "</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Distribution: normal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  location scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'RW' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 6.7e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.67 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:   1 / 900 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 451 / 900 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 900 / 900 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 8.82067 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                5.11786 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                13.9385 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'RW' NOW (CHAIN 2).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Gradient evaluation took 5.5e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.55 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:   1 / 900 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 451 / 900 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 900 / 900 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:  Elapsed Time: 8.95069 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                4.73748 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                13.6882 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-in"><span class="va">fit_apc</span> <span class="op">&lt;-</span> <span class="fu"><a href="apc.html">apc</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_apc</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="stan_rw-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># age-standardized rates</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">standard</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fit_stands</span> <span class="op">&lt;-</span> <span class="fu"><a href="standardize.html">standardize</a></span><span class="op">(</span><span class="va">fit</span>,</span>
<span class="r-in">                          label <span class="op">=</span> <span class="va">standard</span><span class="op">$</span><span class="va">age</span>,</span>
<span class="r-in">                          standard_pop <span class="op">=</span> <span class="va">standard</span><span class="op">$</span><span class="va">standard_pop</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_stands</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Summary of age-standardized surveil model results</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Time periods: 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  time_label stand_rate  .lower  .upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1999    0.00497 0.00496 0.00497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2000    0.00499 0.00499 0.00500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2001    0.00506 0.00506 0.00507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2002    0.00504 0.00503 0.00505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2003    0.00496 0.00495 0.00497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2004    0.00495 0.00494 0.00496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2005    0.00496 0.00495 0.00497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2006    0.00499 0.00498 0.00500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2007    0.00504 0.00503 0.00504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2008    0.00500 0.00500 0.00501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2009    0.00496 0.00495 0.00497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2010    0.00484 0.00484 0.00485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2011    0.00485 0.00484 0.00486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2012    0.00472 0.00472 0.00473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2013    0.00471 0.00470 0.00472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2014    0.00468 0.00467 0.00468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2015    0.00468 0.00467 0.00469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2016    0.00463 0.00462 0.00463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2017    0.00453 0.00453 0.00454</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_stands</span><span class="op">)</span></span>
<span class="r-plt img"><img src="stan_rw-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="va">fit_stands_apc</span> <span class="op">&lt;-</span> <span class="fu"><a href="apc.html">apc</a></span><span class="op">(</span><span class="va">fit_stands</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_stands_apc</span><span class="op">)</span></span>
<span class="r-plt img"><img src="stan_rw-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Connor Donegan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

